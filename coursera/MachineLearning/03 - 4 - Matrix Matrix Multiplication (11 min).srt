1
00:00:00,190 --> 00:00:01,558
このビデオでは、

2
00:00:01,558 --> 00:00:03,577
行列と行列の積、

3
00:00:03,580 --> 00:00:06,262
つまり、2つの行列を掛け合わせるやり方を扱う。

4
00:00:06,590 --> 00:00:07,935
線形回帰ついて話した時に、

5
00:00:07,935 --> 00:00:09,412
パラメータについて、

6
00:00:09,412 --> 00:00:11,251
シータ0、シータ1を

7
00:00:11,251 --> 00:00:13,195
一発で解く方法を話した時に、

8
00:00:13,195 --> 00:00:16,601
勾配降下法のような、繰り返しのアルゴリズムなしで解く方法、

9
00:00:16,601 --> 00:00:18,005
そんなアルゴリズムについて話す時、

10
00:00:18,005 --> 00:00:19,982
行列同士の積は

11
00:00:19,982 --> 00:00:23,086
知らなくてはならない鍵となるステップだ。

12
00:00:24,050 --> 00:00:27,885
ではいつもの通り、例から始めよう。

13
00:00:28,790 --> 00:00:30,558
2つの行列があるとする。

14
00:00:30,558 --> 00:00:33,060
それらを掛け合わせたいとする。

15
00:00:33,060 --> 00:00:34,343
まず実際に例を見て、

16
00:00:34,343 --> 00:00:37,441
その後に何をしたのかについて解説をする。

17
00:00:38,000 --> 00:00:39,154
では、最初に行うのは

18
00:00:39,160 --> 00:00:40,589
この右側の行列の

19
00:00:40,589 --> 00:00:43,154
最初の列を

20
00:00:43,170 --> 00:00:45,545
取り出すことだ。

21
00:00:46,340 --> 00:00:48,135
そしてこの左側の行列を持ってきて、

22
00:00:48,135 --> 00:00:49,163
さきほどのベクトルに

23
00:00:49,170 --> 00:00:52,385
掛け合わせる。

24
00:00:52,385 --> 00:00:55,188
このベクトルは単なる最初の列だ。

25
00:00:55,188 --> 00:00:56,385
計算すると、

26
00:00:56,385 --> 00:00:59,067
ベクトル11、9となる。

27
00:00:59,070 --> 00:01:02,068
つまり、これは前回のビデオでやった

28
00:01:02,068 --> 00:01:05,932
ベクトルと行列の掛け算だ。

29
00:01:05,950 --> 00:01:08,934
私はこれを前もって計算しておいたので、結果が11と9になることを知っている。

30
00:01:08,934 --> 00:01:10,519
次に、二番目に

31
00:01:10,519 --> 00:01:12,811
やらなくてはならないのは、

32
00:01:12,811 --> 00:01:14,752
二番目の列を取り出し、

33
00:01:14,752 --> 00:01:16,537
この右側の行列から、

34
00:01:16,537 --> 00:01:18,575
そしてこの左側の

35
00:01:18,575 --> 00:01:20,174
行列を持ってきて、

36
00:01:20,174 --> 00:01:21,398
つまりあの行列、

37
00:01:21,410 --> 00:01:23,476
それを右側の二番目の列に

38
00:01:23,480 --> 00:01:24,902
掛ける。

39
00:01:24,902 --> 00:01:26,360
だから今回も、

40
00:01:27,060 --> 00:01:28,960
行列とベクトルの掛け算となる。

41
00:01:28,960 --> 00:01:30,643
これは前回のビデオでやったことと同じだ。

42
00:01:30,643 --> 00:01:31,623
この行列と

43
00:01:31,623 --> 00:01:32,768
このベクトルを掛けると、

44
00:01:32,780 --> 00:01:34,250
結果は10と、

45
00:01:34,250 --> 00:01:36,214
14となる。

46
00:01:36,214 --> 00:01:37,472
もし行列とベクトルの掛け算を

47
00:01:37,472 --> 00:01:39,776
練習したいならば、

48
00:01:39,776 --> 00:01:42,810
ビデオを止めて、この掛け算を自分でチェックしてほしい。

49
00:01:43,170 --> 00:01:44,248
次に、

50
00:01:44,248 --> 00:01:45,743
この2つの結果を持ってきて、

51
00:01:45,743 --> 00:01:48,398
一つに合わせる。これが求める答えとなる。

52
00:01:48,400 --> 00:01:49,962
つまり、結果としては、

53
00:01:49,962 --> 00:01:51,350
この積の結果は、

54
00:01:51,350 --> 00:01:53,449
2掛ける2行列で、

55
00:01:53,449 --> 00:01:54,467
この行列を

56
00:01:54,467 --> 00:01:56,294
どう埋めるかというと、

57
00:01:56,294 --> 00:01:57,914
11、4のベクトルの要素を取ってきて

58
00:01:57,914 --> 00:02:00,137
それをここに入れる。

59
00:02:00,140 --> 00:02:03,753
そして10、14を取ってきて、

60
00:02:03,753 --> 00:02:06,386
二番目の列に入れる。

61
00:02:06,720 --> 00:02:06,720
いいかな？

62
00:02:07,430 --> 00:02:08,824
以上が、行列同士の掛け算の

63
00:02:08,824 --> 00:02:11,086
方法の

64
00:02:11,086 --> 00:02:12,248
メカニズムだ。

65
00:02:12,265 --> 00:02:14,094
基本的には、二番目の行列の

66
00:02:14,094 --> 00:02:17,045
各列を一度に一列ずつ見て、そして結果を組み立てる。

67
00:02:17,070 --> 00:02:18,199
少し後に

68
00:02:18,199 --> 00:02:19,455
この手順をより詳しく見ていくが、

69
00:02:19,455 --> 00:02:20,754
その前に

70
00:02:20,754 --> 00:02:22,852
一つ指摘しておきたい。

71
00:02:22,852 --> 00:02:26,301
この最初の例は2x3行列を、

72
00:02:26,301 --> 00:02:28,548
3x2行列に

73
00:02:28,550 --> 00:02:30,649
掛け合わせる。

74
00:02:30,649 --> 00:02:32,497
そしてこの積の結果は

75
00:02:32,497 --> 00:02:35,518
2x2行列と

76
00:02:35,518 --> 00:02:36,802
なる。

77
00:02:36,802 --> 00:02:39,121
これも、もう少ししたら何故成り立つのか、見ることとなる。

78
00:02:39,122 --> 00:02:40,484
いいかな。

79
00:02:40,790 --> 00:02:42,637
以上が計算のメカニズム。

80
00:02:42,637 --> 00:02:43,745
では実際に、詳細を見ていき、

81
00:02:43,745 --> 00:02:44,953
実際に何が起こるのか

82
00:02:44,960 --> 00:02:46,305
見ていこう。

83
00:02:46,305 --> 00:02:48,082
これが詳細だ。

84
00:02:48,082 --> 00:02:49,471
行列Aがあって

85
00:02:49,471 --> 00:02:51,325
それを行列Bと掛け算したい。

86
00:02:51,350 --> 00:02:53,088
そしてその結果は

87
00:02:53,088 --> 00:02:56,143
何らかの新しい行列Cになるとする。

88
00:02:56,143 --> 00:02:57,168
以下の条件を満たす

89
00:02:57,168 --> 00:02:59,238
行列同士しか、掛け合わせられない。

90
00:02:59,238 --> 00:03:00,714
Aの次元が

91
00:03:00,714 --> 00:03:02,239
m掛けるn行列だとすると、

92
00:03:02,240 --> 00:03:04,468
つまりm行n列だとすると、

93
00:03:04,468 --> 00:03:05,394
それはn掛けるoに対して

94
00:03:05,394 --> 00:03:06,480
掛けるとすると、

95
00:03:06,500 --> 00:03:08,232
この、ここのnは

96
00:03:08,232 --> 00:03:10,306
この、こちらのnと 一致していなくてはならない。

97
00:03:10,330 --> 00:03:11,978
つまり最初の行列の列の数は

98
00:03:11,978 --> 00:03:16,778
二番目の行列の行の数と、一致していなくてはならない。

99
00:03:16,800 --> 00:03:18,035
そしてその掛け算の結果は

100
00:03:18,035 --> 00:03:20,639
m掛けるo 行列となる。

101
00:03:20,639 --> 00:03:25,204
ちょうどこの行列Cのように。

102
00:03:25,390 --> 00:03:26,822
そして前回のビデオで

103
00:03:26,830 --> 00:03:28,743
行ったことはすべて、

104
00:03:28,770 --> 00:03:31,380
このoが1、という

105
00:03:31,380 --> 00:03:32,588
特殊なケースだ。

106
00:03:32,588 --> 00:03:33,150
いいかな？

107
00:03:33,150 --> 00:03:35,469
それはBがベクトルの場合だった。

108
00:03:35,480 --> 00:03:36,522
だが今回は、

109
00:03:36,530 --> 00:03:39,805
oが1より大きい。

110
00:03:39,805 --> 00:03:41,533
そこで、2つの行列を

111
00:03:41,540 --> 00:03:44,564
掛け算する方法についてだ。

112
00:03:44,564 --> 00:03:46,349
やっていることは、

113
00:03:46,349 --> 00:03:47,775
行列Bの

114
00:03:47,775 --> 00:03:49,180
最初の列を

115
00:03:49,270 --> 00:03:52,025
取ってきて、

116
00:03:52,025 --> 00:03:53,782
それをベクトルとして扱い、

117
00:03:53,782 --> 00:03:56,098
行列Aを掛ける、

118
00:03:56,120 --> 00:03:57,909
Bの最初の列に。

119
00:03:57,930 --> 00:03:59,632
そして結果は

120
00:03:59,632 --> 00:04:00,370
m掛ける1ベクトルとなる。

121
00:04:00,400 --> 00:04:04,726
それをここに置く。

122
00:04:05,070 --> 00:04:06,481
次に、行列Bの

123
00:04:06,481 --> 00:04:09,048
二番目の列を取り、

124
00:04:09,048 --> 00:04:11,920
いいかな？

125
00:04:12,010 --> 00:04:13,775
これはまた別のn掛ける1ベクトルだ。

126
00:04:13,790 --> 00:04:15,501
つまりこの列、

127
00:04:15,501 --> 00:04:16,690
ここの、n掛ける1ベクトル。

128
00:04:16,690 --> 00:04:17,910
それらn次元ベクトルを、

129
00:04:17,910 --> 00:04:19,782
この行列に掛ける、

130
00:04:19,782 --> 00:04:21,678
このn掛ける1ベクトルに。

131
00:04:21,678 --> 00:04:23,775
その結果は

132
00:04:23,775 --> 00:04:26,018
m次元ベクトルとなり、

133
00:04:26,450 --> 00:04:28,035
それをここに置く。

134
00:04:28,035 --> 00:04:29,273
などなど。

135
00:04:29,273 --> 00:04:30,035
いいかな？

136
00:04:30,035 --> 00:04:31,135
続いて、

137
00:04:31,135 --> 00:04:32,099
三番目の列を取って、

138
00:04:32,099 --> 00:04:33,475
この行列にかける。

139
00:04:33,475 --> 00:04:37,507
そしてm次元ベクトルを得る。

140
00:04:37,510 --> 00:04:39,368
これを最後の列と

141
00:04:39,368 --> 00:04:40,610
行列を掛け合わせて

142
00:04:40,610 --> 00:04:41,870
Cの最後の列を

143
00:04:41,950 --> 00:04:43,420
得るまで

144
00:04:43,530 --> 00:04:45,757
続ける。

145
00:04:46,460 --> 00:04:48,808
もう一度繰り返そう。

146
00:04:49,310 --> 00:04:51,510
行列Cのi番目の列は

147
00:04:51,600 --> 00:04:53,777
以下の手順で得られる、

148
00:04:53,810 --> 00:04:56,108
つまり、行列Aを取って

149
00:04:56,110 --> 00:04:57,641
その行列Aで

150
00:04:57,660 --> 00:04:59,638
行列Bのi番目を取って

151
00:04:59,638 --> 00:05:01,539
掛け算する。

152
00:05:01,560 --> 00:05:03,387
iは1、2、、、と、oまでの値を取る。

153
00:05:03,387 --> 00:05:04,936
いいかな？

154
00:05:04,950 --> 00:05:06,752
これは単に

155
00:05:06,760 --> 00:05:08,765
行列Cを計算するために

156
00:05:08,765 --> 00:05:10,163
やってきたことをまとめただけだ。

157
00:05:10,163 --> 00:05:12,909
もう一つ別の例を見てみよう。

158
00:05:12,940 --> 00:05:17,235
この2つの行列を掛け算したいとする。

159
00:05:17,235 --> 00:05:18,208
そのためには

160
00:05:18,208 --> 00:05:20,178
最初に二番目の行列、

161
00:05:20,178 --> 00:05:22,535
それは前のスライドで言ったBで、

162
00:05:22,535 --> 00:05:24,370
その最初の

163
00:05:24,370 --> 00:05:26,185
列を、

164
00:05:26,185 --> 00:05:29,133
取り出す。

165
00:05:29,160 --> 00:05:30,660
結果として、この行列掛ける、

166
00:05:30,660 --> 00:05:32,917
ベクトルとなり…

167
00:05:32,920 --> 00:05:35,350
ではこの計算を手早く片付けよう。

168
00:05:35,350 --> 00:05:37,518
それはイコール…

169
00:05:37,518 --> 00:05:39,048
1、3掛ける0、3だから

170
00:05:39,048 --> 00:05:41,238
1掛ける0

171
00:05:41,270 --> 00:05:45,930
足すことの3掛ける3。

172
00:05:45,930 --> 00:05:48,322
二番目の要素は

173
00:05:48,322 --> 00:05:49,530
以下のようになる。

174
00:05:49,530 --> 00:05:51,678
2、5掛ける0、3。

175
00:05:51,678 --> 00:05:52,739
つまり、2掛ける0 足す 5掛ける3。

176
00:05:52,740 --> 00:05:57,276
つまり、9、15。

177
00:05:57,276 --> 00:06:02,242
緑で書いておこう。

178
00:06:02,242 --> 00:06:03,672
だから、

179
00:06:03,672 --> 00:06:09,365
9、15。

180
00:06:09,365 --> 00:06:12,061
次に、これの二番目の列を

181
00:06:12,090 --> 00:06:14,451
取り出して、

182
00:06:14,451 --> 00:06:16,174
対応する計算を行う。

183
00:06:16,190 --> 00:06:18,170
だからこの行列掛ける

184
00:06:18,200 --> 00:06:20,477
ベクトル1、2。

185
00:06:20,477 --> 00:06:22,288
これも手早く片付けよう。

186
00:06:22,290 --> 00:06:23,814
それは1掛ける1

187
00:06:23,814 --> 00:06:27,362
足す3掛ける2。

188
00:06:27,362 --> 00:06:28,973
つまり、この列。

189
00:06:28,973 --> 00:06:30,868
ではもう一方も。

190
00:06:30,868 --> 00:06:34,223
つまり

191
00:06:34,223 --> 00:06:37,510
2掛ける1足す

192
00:06:37,510 --> 00:06:41,926
5掛ける2。

193
00:06:41,926 --> 00:06:43,493
つまりイコール…

194
00:06:43,493 --> 00:06:46,176
見てみよう。

195
00:06:46,176 --> 00:06:47,464
1掛ける1足す3掛ける2は7。

196
00:06:47,464 --> 00:06:50,378
そして

197
00:06:50,378 --> 00:06:52,282
2掛ける1足す5掛ける2は

198
00:06:52,282 --> 00:06:53,923
12。

199
00:06:55,570 --> 00:06:56,660
これら2つが得られて、

200
00:06:56,660 --> 00:06:58,448
だから答えは

201
00:06:58,448 --> 00:07:00,343
つまりこれら2つの

202
00:07:00,343 --> 00:07:01,714
行列の積は、

203
00:07:01,714 --> 00:07:03,831
これがここに行き

204
00:07:03,831 --> 00:07:07,232
これが

205
00:07:07,232 --> 00:07:09,828
こちらに行く。

206
00:07:09,828 --> 00:07:14,632
だから、9、 15と

207
00:07:14,660 --> 00:07:17,831
4、 12となる。（訳注記：7、 12の間違い）

208
00:07:17,831 --> 00:07:19,657
そしてこの、

209
00:07:19,670 --> 00:07:21,616
2x2行列と2x2行列を

210
00:07:21,616 --> 00:07:23,687
掛け算した結果、

211
00:07:23,687 --> 00:07:25,215
結果の次元は

212
00:07:25,215 --> 00:07:26,609
最初の2掛ける、

213
00:07:26,609 --> 00:07:28,415
二番目の2で、

214
00:07:28,430 --> 00:07:31,460
結果も2x2行列となる。

215
00:07:35,000 --> 00:07:36,304
最後にもう一つ、

216
00:07:36,304 --> 00:07:37,795
行列どうしの掛け算に使える

217
00:07:37,795 --> 00:07:40,699
便利な技を教えよう。

218
00:07:40,980 --> 00:07:42,455
以前と同様、

219
00:07:42,455 --> 00:07:45,823
4つの家の

220
00:07:45,823 --> 00:07:47,970
価格を予測するとして、

221
00:07:48,410 --> 00:07:49,825
3つの異なる仮説が

222
00:07:49,825 --> 00:07:51,967
ここの右に示すように

223
00:07:51,970 --> 00:07:54,145
あるとする。

224
00:07:54,145 --> 00:07:55,720
そしてこれら3つの仮説それぞれを

225
00:07:55,720 --> 00:07:57,745
4つの家すべてに

226
00:07:57,745 --> 00:07:58,951
適用してみたいとする。

227
00:07:58,951 --> 00:07:59,926
そのとき、行列どうしを掛け算すると

228
00:07:59,926 --> 00:08:01,718
非常に効率的に

229
00:08:01,718 --> 00:08:05,080
行うことができる。

230
00:08:05,110 --> 00:08:07,347
ここ、左にあるのは、何の変哲もない行列、

231
00:08:07,370 --> 00:08:08,626
前回の動画から持ってきた同じもので

232
00:08:08,626 --> 00:08:11,063
これらの値は

233
00:08:11,063 --> 00:08:15,012
家の価格で、左には1を並べてある。

234
00:08:15,012 --> 00:08:16,626
そして私は

235
00:08:16,626 --> 00:08:19,029
別の行列を組み立てる、

236
00:08:19,110 --> 00:08:21,693
それはこれらで、

237
00:08:21,700 --> 00:08:23,477
最初の列は、

238
00:08:23,480 --> 00:08:26,062
この -40、0.25で、

239
00:08:26,070 --> 00:08:28,372
二番目の列は

240
00:08:28,372 --> 00:08:30,945
この200 0.1、などなど。

241
00:08:31,460 --> 00:08:34,278
すると、

242
00:08:34,278 --> 00:08:35,925
これら2つの行列を

243
00:08:35,925 --> 00:08:37,893
掛け算すると、なんと、

244
00:08:37,910 --> 00:08:40,448
そこには

245
00:08:40,448 --> 00:08:43,467
この最初の列、

246
00:08:43,467 --> 00:08:46,340
あー、これはどうやって計算したか？

247
00:08:46,400 --> 00:08:48,850
行列同士の掛け算の

248
00:08:48,850 --> 00:08:50,565
やり方は、

249
00:08:50,565 --> 00:08:51,945
この最初の列を取り出して

250
00:08:51,960 --> 00:08:53,360
この行列を持ってきて

251
00:08:53,420 --> 00:08:54,816
それをこの最初の列に

252
00:08:54,840 --> 00:08:56,724
掛ける。

253
00:08:56,724 --> 00:08:58,540
それは、前のビデオで見たように、

254
00:08:58,540 --> 00:09:00,472
これはまさに、家の価格の

255
00:09:00,490 --> 00:09:02,050
最初の仮説による

256
00:09:02,150 --> 00:09:05,701
予想値だ。

257
00:09:05,701 --> 00:09:08,775
この最初の仮説。これ。

258
00:09:08,790 --> 00:09:10,794
さらに、二番目の列はどうか？

259
00:09:10,794 --> 00:09:12,955
どうやって二列目を計算するか？

260
00:09:12,990 --> 00:09:14,332
二番目の列を得るには、

261
00:09:14,332 --> 00:09:15,548
この行列を取って、

262
00:09:15,590 --> 00:09:19,270
この二番目の列に掛ける。

263
00:09:19,270 --> 00:09:21,293
すると、この二番目の列は

264
00:09:21,293 --> 00:09:24,651
二番目の仮説による

265
00:09:24,651 --> 00:09:27,728
予測値となっている。

266
00:09:27,750 --> 00:09:30,228
ここの二番の仮説。

267
00:09:30,228 --> 00:09:34,450
そして三番目の列も同様。

268
00:09:34,450 --> 00:09:35,809
だから詳細を全部

269
00:09:35,810 --> 00:09:38,058
追うことはしない。

270
00:09:38,058 --> 00:09:39,139
可能ならば、自由にビデオを止めて

271
00:09:39,140 --> 00:09:40,448
計算を自分で

272
00:09:40,448 --> 00:09:41,786
チェックして、

273
00:09:41,786 --> 00:09:43,972
私の言ったことが本当か、確認して欲しい。

274
00:09:43,990 --> 00:09:45,611
これら2つの行列を

275
00:09:45,611 --> 00:09:47,454
作ると、

276
00:09:47,454 --> 00:09:48,937
非常に素早く

277
00:09:48,940 --> 00:09:51,180
この3つの仮説すべてを

278
00:09:51,180 --> 00:09:52,602
4つの家の広さに適用して

279
00:09:52,602 --> 00:09:54,455
12個もの予測値を

280
00:09:54,455 --> 00:09:56,452
一気に求めることができる。

281
00:09:56,452 --> 00:09:57,721
3つの仮説に

282
00:09:57,721 --> 00:10:00,928
4つの家。

283
00:10:00,928 --> 00:10:03,366
つまり、一つの行列の積だけで

284
00:10:03,366 --> 00:10:05,072
12の予測を行うことができ、

285
00:10:05,080 --> 00:10:07,130
さらに良いことに、

286
00:10:07,130 --> 00:10:08,446
この行列の掛け算を

287
00:10:08,446 --> 00:10:09,937
するのに、

288
00:10:09,937 --> 00:10:11,408
実に多くの

289
00:10:11,408 --> 00:10:13,130
非常に良い線形代数のライブラリが

290
00:10:13,150 --> 00:10:14,767
存在している。

291
00:10:14,767 --> 00:10:16,676
この掛け算のステップをやってくれるもの。

292
00:10:16,676 --> 00:10:18,250
これはだいたい普通の言語なら

293
00:10:18,250 --> 00:10:22,025
このようなライブラリがあるはずだ。

294
00:10:22,025 --> 00:10:24,005
間違いなく、人気言語トップ10に入る言語ならすべて、

295
00:10:24,005 --> 00:10:27,898
素晴らしい線形代数のライブラリがあるに違いない。

296
00:10:27,898 --> 00:10:29,554
それらは、その目的のために

297
00:10:29,554 --> 00:10:31,463
高度に最適化されており、

298
00:10:31,463 --> 00:10:33,415
行列同士の掛け算を

299
00:10:33,440 --> 00:10:36,531
非常に効率的にやってくれる。

300
00:10:36,531 --> 00:10:38,501
たとえば並列計算など

301
00:10:38,501 --> 00:10:41,119
あなたのマシンで使えるのなら

302
00:10:41,130 --> 00:10:42,886
使ってもいい。

303
00:10:42,886 --> 00:10:46,297
たとえば複数コアのマシンや

304
00:10:46,330 --> 00:10:48,016
複数プロセッサのマシンや、

305
00:10:48,016 --> 00:10:49,866
プロセッセの中にSIMDなどの

306
00:10:49,866 --> 00:10:53,285
並列計算の機能があるなら。

307
00:10:53,285 --> 00:10:55,242
そんなマシンを使っているなら、

308
00:10:55,242 --> 00:10:56,727
この行列の掛け算をするのに、

309
00:10:56,730 --> 00:10:58,826
非常に良い、

310
00:10:58,826 --> 00:11:00,146
フリーのライブラリがあり

311
00:11:00,146 --> 00:11:02,326
それを使うことで、

312
00:11:02,326 --> 00:11:04,104
非常に効率的に行える。

313
00:11:04,110 --> 00:11:05,908
つまり、多くの仮説による

314
00:11:05,930 --> 00:11:08,738
多くの予測を、非常に効率的に行える。
